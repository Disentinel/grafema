# T7.2: Real Codebase Validation

> Milestone: M7 (Validation & Release) — sync point S6
> Dependencies: M5 (Enrichment), M6 (Compaction)

---

## Validation Plan

### 1. Full Analysis: 2500-File Project

Run Grafema v2 on a real codebase (e.g., Grafema itself or a designated test project):

- [ ] `grafema analyze` completes without errors
- [ ] All node types created correctly
- [ ] All enrichment edges created
- [ ] Query results match v1 (bit-for-bit where possible)
- [ ] No duplicate semantic IDs within any file

### 2. Semantic ID v2 Stability

- [ ] Edit files → verify no cascading ID changes for unrelated nodes
- [ ] Add if-block → child IDs unchanged (no cascade through anonymous scopes)
- [ ] Rename function → only that function's children change

### 3. Incremental Re-Analysis

- [ ] Edit 1 file → CommitBatch → blast radius correct
- [ ] Selective enrichment runs only affected enrichers
- [ ] Graph after incremental = graph after full re-analysis

### 4. Watch Mode: 10 Sequential Edits

Simulate watch mode:
1. Edit file A (add function)
2. Edit file B (change import)
3. Edit file A (rename function)
4. Delete file C
5. Create file D
6. Edit file B (add class)
7. Edit file D (add export)
8. Edit file A (add call to D)
9. Delete file A
10. Edit file B (cleanup)

After each edit: verify graph correctness via queries.

### 5. Bit-for-Bit Query Equivalence

For key query types, compare v1 vs v2 results:
- [ ] `queryNodes({ type: 'FUNCTION' })` — same nodes (modulo ID format)
- [ ] `getOutgoingEdges(functionId, ['CALLS'])` — same targets
- [ ] `getIncomingEdges(moduleId, ['IMPORTS_FROM'])` — same sources
- [ ] Datalog queries return same results
