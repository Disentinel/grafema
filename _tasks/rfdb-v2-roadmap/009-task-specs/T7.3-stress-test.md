# T7.3: Stress Test

> Milestone: M7 (Validation & Release)
> Dependencies: M6 (Compaction + Resources)

---

## Stress Test Plan

### 1. Scale Test: 50M Nodes / 350M Edges

Synthetic graph simulating 100K-file codebase:
- 500 nodes per file × 100K files = 50M nodes
- 7 edges per node average = 350M edges
- ~20 node types, ~15 edge types

**Targets:**
- [ ] Graph loads without OOM
- [ ] v2 memory: <500MB (where v1 would need ~20GB for HashMap)
- [ ] Write throughput: >100K nodes/sec sustained
- [ ] Compaction completes in reasonable time (<10 min)

### 2. Query Latency Under Load

While writes happening:
- [ ] Point lookup: <1ms p99
- [ ] Attribute query (10K results): <100ms p99
- [ ] Neighbor query: <10ms p99
- [ ] BFS depth 3: <500ms p99

### 3. Concurrent Clients

- [ ] 4 clients writing to different databases simultaneously
- [ ] 2 clients reading + 1 writing to same database
- [ ] No deadlocks, no corruption

### 4. Crash Recovery

- [ ] Kill server mid-batch → restart → previous snapshot intact
- [ ] Kill during compaction → restart → no data loss
- [ ] Kill during manifest swap → restart → valid state (old or new)
- [ ] Orphan segments cleaned up on GC

### 5. Long-Running Stability

- [ ] 1000 incremental updates → no memory growth (no leaks)
- [ ] Compaction keeps segment count bounded
- [ ] GC removes old segments
- [ ] Tombstone accumulation bounded by compaction
